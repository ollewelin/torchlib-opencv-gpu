(base) olle@olle-TUF-Gaming-FX505DT-FX505DT:~/pytorch_cpp$ make
Consolidate compiler generated dependencies of target main
[ 50%] Building CXX object CMakeFiles/main.dir/main.cpp.o
[100%] Linking CXX executable main
[100%] Built target main
(base) olle@olle-TUF-Gaming-FX505DT-FX505DT:~/pytorch_cpp$ ./main
 0  0  0  0  0
 0  0  0  0  0
[ CPUFloatType{2,5} ]
 0
 0
 0
 0
 0
[ CPUFloatType{5} ]
  0  16   0   0   0
  0   0   0   0   0
[ CPUFloatType{2,5} ]
CUDA is available! 
 0.1842  0.2198  0.0646
 0.8500  0.4597  0.8239
 0.0900  0.0491  0.1566
 0.0741  0.0114  0.9229
 0.7175  0.5140  0.7413
[ CUDAFloatType{5,3} ]
 0.1842  0.2198  0.0646  0.8500  0.4597
 0.8239  0.0900  0.0491  0.1566  0.0741
 0.0114  0.9229  0.7175  0.5140  0.7413
[ CUDAFloatType{3,5} ]
 17.3000   0.2198   0.0646   0.8500   0.4597
  0.8239   0.0900   0.0491   0.1566   0.0741
  0.0114   0.9229   0.7175   0.5140   0.7413
[ CUDAFloatType{3,5} ]
 0  0  0
 0  0  0
[ CPUFloatType{2,3} ]
  0  16   0   0   0
  0   0   0   0   0
[ CUDAFloatType{2,5} ]
More basic tests
 3
 2
[ CUDALongType{2} ]
************* GPU t5 tensor **************
 11  12  13
 14  15  16
[ CUDAFloatType{2,3} ]
************* Reshape t5 tensor code  t5.reshape({3,2}) no change **************
 11  12  13
 14  15  16
[ CUDAFloatType{2,3} ]
************* Reshape t5 = t5.reshape({3,2})  t5 tensor **************
 11  12
 13  14
 15  16
[ CUDAFloatType{3,2} ]
c1_cpu = a1_cpu * b1_cpu = 14.266
[ CPUFloatType{} ]
a1_cpu gradient = 2.8532
[ CPUFloatType{} ]
b1_cpu gradient = [ Tensor (undefined) ]
PyTorch Basics

c1_gpu = a1_gpu * b1_gpu =    0  256    0    0    0
   0    0    0    0    0
[ CPUFloatType{2,5} ]
terminate called after throwing an instance of 'c10::Error'
  what():  grad can be implicitly created only for scalar outputs
Exception raised from _make_grads at ../torch/csrc/autograd/autograd.cpp:47 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0x69 (0x7f8046af9eb9 in /home/olle/pytorch_cpp/libtorch/lib/libc10.so)
frame #1: <unknown function> + 0x3390ad0 (0x7f8039703ad0 in /home/olle/pytorch_cpp/libtorch/lib/libtorch_cpu.so)
frame #2: torch::autograd::backward(std::vector<at::Tensor, std::allocator<at::Tensor> > const&, std::vector<at::Tensor, std::allocator<at::Tensor> > const&, c10::optional<bool>, bool) + 0x41 (0x7f8039705be1 in /home/olle/pytorch_cpp/libtorch/lib/libtorch_cpu.so)
frame #3: <unknown function> + 0x3841f1e (0x7f8039bb4f1e in /home/olle/pytorch_cpp/libtorch/lib/libtorch_cpu.so)
frame #4: <unknown function> + 0x307942b (0x7f80393ec42b in /home/olle/pytorch_cpp/libtorch/lib/libtorch_cpu.so)
frame #5: at::Tensor::backward(at::Tensor const&, c10::optional<bool>, bool) const + 0x115 (0x7f8037781595 in /home/olle/pytorch_cpp/libtorch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0xa92f (0x5631b123492f in ./main)
frame #7: __libc_start_main + 0xe7 (0x7f7ff5426bf7 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x8bba (0x5631b1232bba in ./main)

Aborted (core dumped)
(base) olle@olle-TUF-Gaming-FX505DT-FX505DT:~/pytorch_cpp$ 
